# PCA
> **ê³ ì°¨ì›ì—ì„œ ì €ì°¨ì›ìœ¼ë¡œì˜ ì°¨ì› ì¶•ì†Œ ê¸°ë²•ìœ¼ë¡œ PCA ë¼ê³ ë„ í•œë‹¤.**
**ë°ì´í„°ì— ëŒ€í•´ ê°€ì¥ ë§ì€ ì •ë³´ë¥¼ ë‚¨ê¸°ê¸° ìœ„í•œ ë°©ë²•ì´ë©°, ì´ë¥¼ ìœ„í•´ ë¶„ì‚°ì´ í° ê²ƒì„ ì„ íƒí•œë‹¤.**

**ëª©í‘œëŠ” í–‰ë ¬ì„ ë‚®ì€ ì°¨ì›ì˜ í–‰ë ¬ë¡œ ë³€í™˜í•œ í›„, ë¶„ì‚°ì´ ê°€ì¥ í° kê°œë¥¼ ì„ íƒí•˜ì—¬ ìµœëŒ€í•œ ë§ì€ ì •ë³´ë¥¼ ë‚¨ê¸°ëŠ” ê²ƒì´ë‹¤.**

-  ë¶„ì‚°ì´ ì»¤ ë°ì´í„°ê°€ ë§ì´ í¼ì ¸ ìˆëŠ” ë°©í–¥ì¼ìˆ˜ë¡ ë°ì´í„°ê°€ ë” ë‹¤ì–‘í•œ ê°’ì„ ê°€ì§€ë¯€ë¡œ, ë” ë§ì€ ì •ë³´ë¥¼ ë‹´ê³  ìˆë‹¤ê³  ë³¼ ìˆ˜ ìˆë‹¤.
- ì„ íƒëœ ê° ì£¼ì„±ë¶„ë“¤ì€ x, y, z, ...  ì¶•ê³¼ í‰í–‰í•˜ì§€ ì•Šì„ ìˆ˜ë„ ìˆë‹¤.
## ê³ ìœ³ê°’ ë¶„í•´
ğŸ“Œ **ê³ ìœ³ê°’ ë¶„í•´ì˜ í•µì‹¬** 
ì–´ë–¤ ì •ë°©í–‰ë ¬ ğ´ì— ëŒ€í•´ **ê³ ìœ³ê°’ ğœ†ê³¼ ê³ ìœ ë²¡í„° ğ‘£**ëŠ” ë‹¤ìŒ ê´€ê³„ë¥¼ ë§Œì¡±í•œë‹¤.
- $Av = \lambda v$

- **ì¦‰, ì •ë°©í–‰ë ¬ Aì— ëŒ€í•´, ë°©í–¥ì„ ë°”ê¾¸ì§€ ì•Šê³  í¬ê¸°ë§Œ ë³€í™”ì‹œí‚¤ëŠ” vector $v$ ê°€ ì¡´ì¬í•œë‹¤.**
## ê³¼ì •
1. **dì°¨ì› ë°ì´í„°ì…‹ì„ í‘œì¤€í™” ì „ì²˜ë¦¬í•œë‹¤.**
	
    - PCAëŠ” ë¶„ì‚°ì„ ë‹¤ë£¨ê¸° ë•Œë¬¸ì— ë°ì´í„° ìŠ¤ì¼€ì¼ì— ì˜í–¥ì„ í¬ê²Œ ë°›ëŠ”ë‹¤.
2. **Covariance matrix ë¥¼ ë§Œë“ ë‹¤.**
	
    - $N$ x $N$ í–‰ë ¬ì´ê³  , $C^T = C$ ì´ë‹¤.
3. **Covariance matrix ë¥¼ eigenvectorì™€ eigenvalue ë¡œ ë¶„í•´í•œë‹¤.**
4. **Eigenvalue ë¥¼ ì •ë ¬í•œë‹¤.**
5. **ê³ ìœ³ê°’ì´ ê°€ì¥ í° $k$ ê°œì˜ eigenvectorë¥¼ ì„ íƒí•œë‹¤.**

	- ê³ ìœ³ê°’ì€ í•´ë‹¹ **ê³ ìœ ë²¡í„°(ì£¼ì„±ë¶„)ê°€ ë‚˜íƒ€ë‚´ëŠ” ë°ì´í„°ì˜ ë¶„ì‚° í¬ê¸°**ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤.
    - ê³ ìœ³ê°’ì´ í¬ë‹¤ëŠ” ê²ƒì€ **ë°ì´í„°ê°€ ê·¸ ì£¼ì„±ë¶„ ë°©í–¥ìœ¼ë¡œ ë” ë§ì´ í¼ì ¸ ìˆë‹¤ëŠ” ê²ƒì´ê³ , ì´ëŠ” ê·¸ ë°©í–¥ì— ë” ë§ì€ ì •ë³´ê°€ ìˆë‹¤**ëŠ” ëœ»ì´ë‹¤.
6. **ìµœìƒìœ„ $k$ ê°œì˜ eigenvector ë¡œ Projection matrix Wë¥¼ ë§Œë“ ë‹¤.**
7. **Projection matrix W ë¥¼ ì‚¬ìš©í•˜ì—¬ $d$ ì°¨ì› ì…ë ¥ ë°ì´í„°ì…‹ Xë¥¼ ìƒˆë¡œìš´ $k$ ì°¨ì›ì˜ íŠ¹ì„± ë¶€ë¶„ ê³µê°„ìœ¼ë¡œ ë³€í™˜í•œë‹¤.**

![](https://velog.velcdn.com/images/kvvon/post/c854ad32-0ff8-426e-9d7e-3637dd30aaa8/image.png)![](https://velog.velcdn.com/images/kvvon/post/5197ac37-4291-4958-b753-78976a70692e/image.png)![](https://velog.velcdn.com/images/kvvon/post/ced5741f-27e3-4a73-9765-682f1154634b/image.png)![](https://velog.velcdn.com/images/kvvon/post/f81d3414-d6da-43c0-9a76-f9accf697a2c/image.png) ![](https://velog.velcdn.com/images/kvvon/post/d7b3dea5-1e8c-41ff-8618-476e0b7208c1/image.png)

## PCA íŒŒì´ì¬ìœ¼ë¡œ êµ¬í˜„í•˜ê¸°
![](https://velog.velcdn.com/images/kvvon/post/ab164d3a-eb43-48bf-8c24-46b7c4db054c/image.png) ![](https://velog.velcdn.com/images/kvvon/post/ad612d00-1553-44a3-885e-fdeec00b8d89/image.png) ![](https://velog.velcdn.com/images/kvvon/post/85ac1d24-7cb9-4904-afd7-618640748e6d/image.png)![](https://velog.velcdn.com/images/kvvon/post/de9afb30-3fbb-469a-ab43-2cd48ecbf54a/image.png)

- ê²°ê³¼ë¥¼ ë³´ë©´ **Xì¶• (ì œ1ì£¼ì„±ë¶„) ë°©í–¥ìœ¼ë¡œ ë°ì´í„°ê°€ ë¹„êµì  ë„“ê²Œ í´ì ¸ìˆëŠ” ê²ƒ**ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. 

### Explained variance ratio
> **íŠ¹ì„± ê³ ìœ ê°’ì„ ì „ì²´ ê³ ìœ³ê°’ì˜ í•©ìœ¼ë¡œ ë‚˜ëˆˆ ê²ƒ**

- $k$ ê°œì˜ íŠ¹ì„±ì„ ì„ íƒí•˜ê¸° ì „ì— íŠ¹ì • Eigenvalue ê°€ ì°¨ì§€í•˜ëŠ” ë¹„ìœ¨ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

## PCA ì‚¬ì´í‚·ëŸ°ìœ¼ë¡œ êµ¬í˜„í•˜ê¸°
```python
from sklearn.decomposition import PCA
# ì£¼ì„±ë¶„ ê°œìˆ˜ ì§€ì •
pca = PCA(n_components=2)

# ì°¨ì› ì¶•ì†Œ
X_train_pca = pca.fit_transform(X_train_std)
X_train_pca = pca.transform(X_test_std)

# ì „ì²´ ì£¼ì„±ë¶„ ëª¨ë‘ ì‚¬ìš©
pca = PCA(n_components=None)
X_train_pca = pca.fit_transform(X_train_std)

# ì „ì²´ ì£¼ì„±ë¶„ì˜ Explained variance ratioë¥¼ í™•ì¸í•˜ì
print(pca.explained_variance_ratio_)

# n_components = 0 ~ 1 ì‚¬ì´ ì‹¤ìˆ˜
# Cumulative Explained variance ratioê°€ ì‹¤ìˆ˜ê°’ ì´ìƒì´ ë  ë•Œê¹Œì§€ ì§„í–‰
pca = PCA(n_components=0.8)
```
- ì‚¬ì´í‚·ëŸ°ì˜ PCA í´ë˜ìŠ¤ëŠ” **Singular decomposition ë°©ì‹ìœ¼ë¡œ ê³ ìœ³ê°’ ë¶„í•´ë¥¼ ì§„í–‰í•œë‹¤**.

```python
from sklearn.decomposition import IncrementalPCA
ipca = IncrementalPCA(n_components = 9)

for batch in range(len(X_train_std)//25+1):
	X_batch = X_train_std[batch*25:(batch+1)*25]
	ipca.partial_fit(X_batch)
```

- ì „ì²´ ë°ì´í„°ë¥¼ í•œ ë²ˆì— ì²˜ë¦¬í•˜ëŠ” PCAì™€ ë‹¬ë¦¬, **IncrementalPCAëŠ” ì‘ì€ ë°°ì¹˜ ë‹¨ìœ„ë¡œ ë°ì´í„°ë¥¼ ì—…ë°ì´íŠ¸í•˜ë©´ì„œ ì£¼ì„±ë¶„ì„ í•™ìŠµí•œë‹¤**.
- ë©”ëª¨ë¦¬ ì ˆì•½ì´ ê°€ëŠ¥í•˜ë‹¤.

## íŠ¹ì„± ê¸°ì—¬ë„(Loading) í™•ì¸
> **Loading(ë¡œë”© í–‰ë ¬)ì€ ê° ì›ë³¸ íŠ¹ì„±ì´ ì£¼ì„±ë¶„ì— ì–¼ë§ˆë‚˜ ê¸°ì—¬í•˜ëŠ”ì§€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ê°’ì´ë‹¤.ì´ëŠ” ì£¼ì„±ë¶„ì„ í•´ì„í•˜ëŠ” ì¤‘ìš”í•œ ì§€í‘œë¡œ, íŠ¹ì • ì£¼ì„±ë¶„ì´ ì–´ë–¤ ì›ë³¸ íŠ¹ì„±ê³¼ ê´€ë ¨ì´ ìˆëŠ”ì§€ë¥¼ íŒŒì•…í•  ìˆ˜ ìˆë‹¤.**

![](https://velog.velcdn.com/images/kvvon/post/8dd9b95e-821a-4367-9105-68f73fda7ae8/image.png) ![](https://velog.velcdn.com/images/kvvon/post/e76915d5-30b5-4b4f-b1fa-cd8f66be3c25/image.png)![](https://velog.velcdn.com/images/kvvon/post/ae8a1638-aa22-4909-b53f-6bc47f01f074/image.png) ![](https://velog.velcdn.com/images/kvvon/post/65dd8467-6dc7-4114-8837-ca3f9ece29f3/image.png) ![](https://velog.velcdn.com/images/kvvon/post/08c98d25-8940-4342-9933-2575f026ada5/image.png)

- **Eigen vector ìì²´ê°€ Covariance matrixë¡œë¶€í„° ë„ì¶œë˜ì—ˆê¸° ë•Œë¬¸**ì— ê°€ëŠ¥í•˜ë‹¤ê³  ìƒê°í•˜ë©´ í¸í•˜ë‹¤.

- **ì–‘ì˜ ìƒê´€ê´€ê³„**: ì •ë¹„ë¡€
- **ìŒì˜ ìƒê´€ê´€ê³„**: ë°˜ë¹„ë¡€

### íŒŒì´ì¬ìœ¼ë¡œ êµ¬í˜„
```python
loadings = eigen_vecs * np.sqrt(eigen_vals)
```

### ì‚¬ì´í‚·ëŸ°ìœ¼ë¡œ êµ¬í˜„
```python
from sklearn.decompositino import PCA

sklearn_loadings = pca.components_.T * np.sqrt(pca.explaned_variance_)
```

